!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@fmfe/tms.js")):"function"==typeof define&&define.amd?define(["@fmfe/tms.js"],e):t.VueTms=e(t.Tms)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e};return function(s){function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,u);var e=i(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));if(e.onList=[],e.subs=[],e.options={isDebugLog:!1},"boolean"==typeof t.isDebugLog&&(e.options.isDebugLog=t.isDebugLog),!u._Vue)throw new Error("Please install with Vue.use(VueTms).");return e.app=null,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,t),n(u,[{key:"run",value:function(){var o=this;if(Object.defineProperty(this,"app",{enumerable:!1}),Object.defineProperty(this,"subs",{enumerable:!1}),Object.defineProperty(this,"onList",{enumerable:!1}),!u._Vue)return this;this.app=new u._Vue({data:this});return function n(i,s){Object.keys(i).forEach(function(u){var a=i[u];if(a instanceof t){var f=function(t){var n,i=""+s.concat([u,t.type]).join(".");o.options.isDebugLog&&console&&console.log("position   "+i+"(payload: "+(n=t.payload,Object.prototype.toString.call(n).replace(/^(.*?) |]$/g,"").toLowerCase())+");","\n\rpayload   ","object"===e(t.payload)?JSON.parse(JSON.stringify(t.payload)):t.payload,"\n\rpayloads  ",JSON.parse(JSON.stringify(t.payloads)),"\n\rtarget    ",t.target,"\n\r---"),o.subs.forEach(function(e){return e(r({},t,{position:i,time:Date.now()}))})};a.dep.addSub(f),o.onList.push({target:a,onChage:f}),n(a,[].concat(function(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return Array.from(t)}(s),[u]))}})}(this,[]),this}},{key:"subscribe",value:function(t){return this.subs.push(t),this}},{key:"unsubscribe",value:function(t){var e=this.subs.indexOf(t);return this.subs.splice(e,1),this}},{key:"destroy",value:function(){return this.app&&(this.app.$destroy(),this.onList.forEach(function(t){t.target.dep.removeSub(t.onChage)})),this.onList.splice(0,this.onList.length),this.subs.splice(0,this.subs.length),this}}],[{key:"install",value:function(t,e){u._Vue=t,Object.defineProperty(u._Vue.prototype,"$store",{get:function(){return this.$root._store}}),Object.defineProperty(u._Vue.prototype,"_store",{get:function(){return this.$options.store}}),u._Vue.mixin({destroyed:function(){this.$options.store&&this.$options.store.destroy()}})}}]),u}()});
