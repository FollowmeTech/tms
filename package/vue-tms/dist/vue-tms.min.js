!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueTms=e()}(this,function(){"use strict";var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};return function(){function r(){if(t(this,r),this.onList=[],this.subs=[],!r._Vue||!r._Tms)throw new Error("Please install with Vue.use(VueTms, Tms).");this.app=null}return e(r,[{key:"run",value:function(){var t=this;if(Object.defineProperty(this,"app",{enumerable:!1}),Object.defineProperty(this,"subs",{enumerable:!1}),Object.defineProperty(this,"onList",{enumerable:!1}),!r._Vue)return this;this.app=new r._Vue({data:this});return function e(o,s){Object.keys(o).forEach(function(i){var u=o[i];if(r._Tms&&u instanceof r._Tms){var a=function(e){var r,o=""+s.concat([i,e.type]).join(".");"production"!==process.env.NODE_ENV&&console.log("type       "+o+"(payload: "+(r=e.payload,Object.prototype.toString.call(r).replace(/^(.*?) |]$/g,"").toLowerCase())+");","\n\rpayload   ",e.payload,"\n\rpayloads  ",e.payloads,"\n\rtarget    ",e.target,"\n\r---"),t.subs.forEach(function(t){return t(n({},e,{position:o,time:Date.now()}))})};u.dep.addSub(a),t.onList.push({target:u,onChage:a}),e(u,[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(s),[i]))}})}(this,[]),this}},{key:"subscribe",value:function(t){return this.subs.push(t),this}},{key:"unsubscribe",value:function(t){var e=this.subs.indexOf(t);return this.subs.splice(e,1),this}},{key:"destroy",value:function(){return this.app&&(this.app.$destroy(),this.onList.forEach(function(t){t.target.dep.removeSub(t.onChage)})),this.onList.splice(0,this.onList.length),this.subs.splice(0,this.subs.length),this}}],[{key:"install",value:function(t,e){r._Vue=t,r._Tms=e,Object.defineProperty(r._Vue.prototype,"$store",{get:function(){return this.$root._store}}),Object.defineProperty(r._Vue.prototype,"_store",{get:function(){return this.$options.store}}),r._Vue.mixin({destroyed:function(){this.$options.store&&this.$options.store.destroy()}})}}]),r}()});
